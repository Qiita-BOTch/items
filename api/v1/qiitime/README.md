## このスクリプトについて

このスクリプトは Qiitadon の時報トゥート「[@​QiiTime​](https://qiitadon.com/@QiiTime)」の本体プログラムです。

下記「リクエスト URL」にアクセスすると、最後の時報に関する JSON データを取得できます。

## 用途／目的

### TL;DR

LTL には流したくないが、タグ検索にヒットさせたいトゥートなどを日記がわりにお使いください。

### TS;DR

- この**時報トゥートに対して返信トゥートする**ことで、LTL（ローカル・タイム・ライン）には流れないが、タグ検索でヒットするトゥートをすることができます。
- 現在の返信先のトゥート ID（Status ID）を知りたい場合は、下記「リクエスト URL」の API を叩くと、JSON 形式で取得できます。
- 時報トゥートには `#2018_08_31_02` といった日時のタグが付きます。

## 仕様

- １時間ごとに時報を Qiitadon でトゥートします。
- 最後にトゥートした日時を「`YmdH`」フォーマットにした整数を `threshold` と呼んでいます。
- 現時刻が `threshold` の値を超えていない場合は、最後の時報トゥートの情報を返します。返されるデータは下記「レスポンス内容」をご覧ください。
- 現時刻が `threshold` の値が現時刻より大きい場合は、時報をトゥートし `threshold` を更新し、そのトゥートの情報を返します。
- レスポンスは JSON データです。
- JSON データは URL などのスラッシュ、またはユニコードなどをエスケープしています。
- `threshold` のタイムスタンプのタイムゾーンは「`Asia/Tokyo`」です。


## リクエスト URL

```
https://qithub.tk/api/v1/qiitime/
```

## レスポンス内容

下記 JSON の１次元データが返されます。

|Attribute    |Description                               |Type     |
|:------------- |:-------------------------------------- |:-------:|
| `threshold`   | 'YmdH'形式のタイムスタンプ             | integer |
| `is_cache`    | 時報済みか否か                         | boolean |
| `id`          | 時報トゥート（`status`）の ID          | integer |
| `uri`         | 連合内のユニークなリソース ID          | string  |
| `url`         | 時報トゥートのインスタンス上の URL     | string  |
| `created_at`  | 時報トゥートが作成された時刻           | string  |
| `requested_at`| 時報トゥートが作成された時刻           | string  |

### レスポンスのサンプル

`2018/08/31 11時`の時報の場合のレスポンス内容。

```json
{
    "id": "100642476842849640",
    "uri": "https:\/\/qiitadon.com\/users\/QiiTime\/statuses\/000000000000000000",
    "url": "https:\/\/qiitadon.com\/@QiiTime\/000000000000000000",
    "created_at": "2018-08-31T02:25:24.884Z",
    "threshold": "201808311125"
}
```
